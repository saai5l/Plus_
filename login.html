<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plus Dev â€” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
  <link rel="icon" type="image/png" href="https://cdn.discordapp.com/avatars/990216490085142578/4b1d6f63ac4b6e1a59a320ef820a2053.png?size=64">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
  <meta name="theme-color" content="#fc7823">
  <style>
    :root {
      --primary:      #fc7823;
      --primary-dark: #e66a1f;
      --primary-glow: rgba(252,120,35,0.35);
      --bg-deep:      #050505;
      --bg-card:      rgba(14,14,14,0.97);
      --bg-input:     rgba(255,255,255,0.06);
      --border:       rgba(255,255,255,0.07);
      --border-focus: rgba(252,120,35,0.6);
      --text:         #e0e0e0;
      --text-muted:   #777;
      --discord:      #5865F2;
      --discord-dark: #4752c4;
      --radius:       14px;
      --tr:           all 0.3s ease;
    }
    *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

    body {
      font-family:'Tajawal',sans-serif;
      background: var(--bg-deep);
      color: var(--text);
      min-height: 100vh;
      display: flex; align-items: center; justify-content: center;
      overflow: hidden; position: relative;
    }

    /* â”€â”€â”€ Animated mesh background â”€â”€â”€ */
    .bg {
      position: fixed; inset: 0; z-index: 0;
      background:
        radial-gradient(ellipse 80% 60% at 15% 10%, rgba(252,120,35,0.09) 0%, transparent 65%),
        radial-gradient(ellipse 70% 50% at 85% 90%, rgba(252,120,35,0.06) 0%, transparent 65%),
        radial-gradient(ellipse 100% 100% at 50% 50%, #050505 40%, #050505 100%);
    }

    /* â”€â”€â”€ Particles â”€â”€â”€ */
    .particle {
      position: fixed; border-radius: 50%; pointer-events: none;
      opacity: 0; animation: floatUp linear infinite;
    }
    @keyframes floatUp {
      0%   { transform: translateY(110vh) scale(0.2); opacity: 0; }
      8%   { opacity: 0.5; }
      92%  { opacity: 0.12; }
      100% { transform: translateY(-10vh) scale(1); opacity: 0; }
    }

    /* â”€â”€â”€ Card â”€â”€â”€ */
    .card {
      position: relative; z-index: 2;
      background: var(--bg-card);
      border: 1px solid rgba(252,120,35,0.1);
      border-radius: 24px;
      padding: 44px 40px 36px;
      width: 100%; max-width: 440px;
      box-shadow:
        0 0 0 1px rgba(252,120,35,0.06),
        0 32px 80px rgba(0,0,0,0.75),
        inset 0 1px 0 rgba(255,255,255,0.04);
      animation: cardIn .65s cubic-bezier(.22,1,.36,1) both;
    }
    @keyframes cardIn {
      from { opacity:0; transform: translateY(36px) scale(0.97); }
      to   { opacity:1; transform: translateY(0) scale(1); }
    }

    /* Orange top accent */
    .card::before {
      content:'';
      position: absolute; top:0; left:28px; right:28px; height:2.5px;
      background: linear-gradient(90deg, transparent, var(--primary), transparent);
      border-radius: 0 0 6px 6px;
    }

    /* â”€â”€â”€ Logo â”€â”€â”€ */
    .logo { text-align:center; margin-bottom:30px; }
    .logo img {
      width:70px; height:70px; border-radius:50%;
      border: 2px solid rgba(252,120,35,0.45);
      box-shadow: 0 0 22px var(--primary-glow);
      animation: glow 3s ease-in-out infinite;
    }
    @keyframes glow {
      0%,100% { box-shadow: 0 0 22px var(--primary-glow); }
      50%      { box-shadow: 0 0 38px rgba(252,120,35,0.55); }
    }
    .logo h1 { margin-top:13px; font-size:1.5rem; font-weight:900; color:#fff; letter-spacing:-.5px; }
    .logo h1 span { color:var(--primary); }
    .logo p { font-size:.84rem; color:var(--text-muted); margin-top:3px; }

    /* â”€â”€â”€ Tabs â”€â”€â”€ */
    .tabs {
      display:flex; gap:5px;
      background:rgba(255,255,255,0.04);
      border-radius:10px; padding:4px;
      margin-bottom:26px;
    }
    .tab {
      flex:1; padding:9px 0;
      border:none; border-radius:7px;
      font-family:'Tajawal',sans-serif; font-size:.9rem; font-weight:700;
      color:var(--text-muted); background:transparent; cursor:pointer;
      transition: var(--tr);
    }
    .tab.on {
      background: linear-gradient(135deg,var(--primary),var(--primary-dark));
      color:#fff;
      box-shadow: 0 4px 14px rgba(252,120,35,0.32);
    }
    .tab i { margin-left:5px; }

    /* â”€â”€â”€ Panels â”€â”€â”€ */
    .panel { display:none; animation: pan .3s ease; }
    .panel.on { display:block; }
    @keyframes pan {
      from { opacity:0; transform:translateY(7px); }
      to   { opacity:1; transform:translateY(0); }
    }

    /* â”€â”€â”€ Alert â”€â”€â”€ */
    .alert {
      display:none; align-items:center; gap:9px;
      padding:11px 14px; border-radius:10px;
      font-size:.86rem; font-weight:600;
      margin-bottom:18px;
      animation: aIn .3s ease;
    }
    @keyframes aIn { from{opacity:0;transform:translateY(-5px)} to{opacity:1;transform:none} }
    .alert.on  { display:flex; }
    .alert.err { background:rgba(231,76,60,.14); border:1px solid rgba(231,76,60,.35); color:#ff7070; }
    .alert.ok  { background:rgba(46,204,113,.11); border:1px solid rgba(46,204,113,.3);  color:#5dda8f; }
    .alert.inf { background:rgba(252,120,35,.11); border:1px solid rgba(252,120,35,.3);  color:#fca366; }

    /* â”€â”€â”€ Discord button â”€â”€â”€ */
    .discord-btn {
      width:100%; display:flex; align-items:center; justify-content:center; gap:11px;
      padding:14px; background:linear-gradient(135deg,var(--discord),var(--discord-dark));
      border:none; border-radius:var(--radius); color:#fff;
      font-family:'Tajawal',sans-serif; font-size:1.05rem; font-weight:800;
      cursor:pointer; transition:var(--tr);
      box-shadow: 0 6px 20px rgba(88,101,242,.35);
      position:relative; overflow:hidden;
    }
    .discord-btn::after { content:''; position:absolute; inset:0; background:rgba(255,255,255,.1); opacity:0; transition:opacity .3s; }
    .discord-btn:hover  { transform:translateY(-2px); box-shadow:0 10px 28px rgba(88,101,242,.5); }
    .discord-btn:hover::after { opacity:1; }
    .discord-btn i { font-size:1.25rem; }
    .discord-note { font-size:.8rem; color:var(--text-muted); text-align:center; margin-top:12px; line-height:1.55; }

    /* â”€â”€â”€ Divider â”€â”€â”€ */
    .div {
      display:flex; align-items:center; gap:10px;
      color:var(--text-muted); font-size:.8rem; margin:20px 0;
    }
    .div::before,.div::after { content:''; flex:1; height:1px; background:var(--border); }

    /* â”€â”€â”€ Link banner â”€â”€â”€ */
    .link-banner {
      display:none; padding:13px 15px;
      background:linear-gradient(135deg,rgba(88,101,242,.12),rgba(252,120,35,.07));
      border:1px solid rgba(88,101,242,.3); border-radius:12px; margin-bottom:18px;
      font-size:.84rem; color:var(--text-muted); line-height:1.6;
    }
    .link-banner.on { display:block; }
    .link-banner strong { color:#9da7fb; }
    .link-actions { display:flex; gap:8px; margin-top:10px; }
    .lbtn {
      flex:1; padding:9px; border-radius:8px; border:none;
      font-family:'Tajawal',sans-serif; font-size:.85rem; font-weight:800;
      cursor:pointer; transition:var(--tr);
    }
    .lbtn-y { background:var(--discord); color:#fff; }
    .lbtn-y:hover { background:var(--discord-dark); }
    .lbtn-n { background:rgba(255,255,255,.07); color:var(--text-muted); }
    .lbtn-n:hover { background:rgba(255,255,255,.13); }

    /* â”€â”€â”€ Form fields â”€â”€â”€ */
    .fg { margin-bottom:15px; }
    label { display:block; font-size:.83rem; font-weight:700; color:var(--text-muted); margin-bottom:6px; }
    .iw { position:relative; }
    .iw i.ic { position:absolute; top:50%; transform:translateY(-50%); right:13px; color:var(--text-muted); font-size:.88rem; pointer-events:none; transition:color .3s; }
    input[type="email"],input[type="password"],input[type="text"] {
      width:100%; padding:12px 40px 12px 42px;
      background:var(--bg-input); border:1.5px solid var(--border); border-radius:10px;
      color:var(--text); font-family:'Tajawal',sans-serif; font-size:.95rem; outline:none;
      transition:var(--tr);
    }
    input:focus {
      border-color:var(--border-focus);
      background:rgba(252,120,35,.05);
      box-shadow:0 0 0 3px rgba(252,120,35,.1);
    }
    input:focus ~ i.ic,.iw:focus-within i.ic { color:var(--primary); }
    input::placeholder { color:rgba(255,255,255,.22); }

    /* Eye toggle */
    .eye {
      position:absolute; top:50%; transform:translateY(-50%); left:11px;
      background:none; border:none; color:var(--text-muted); cursor:pointer; font-size:.88rem; padding:4px;
      transition:color .3s;
    }
    .eye:hover { color:var(--primary); }

    /* â”€â”€â”€ Extras â”€â”€â”€ */
    .extras { display:flex; align-items:center; justify-content:space-between; margin-bottom:20px; font-size:.82rem; }
    .rem { display:flex; align-items:center; gap:7px; cursor:pointer; color:var(--text-muted); user-select:none; }
    .rem input[type="checkbox"] { accent-color:var(--primary); width:14px; height:14px; }
    .forgot { color:var(--primary); text-decoration:none; transition:opacity .3s; }
    .forgot:hover { opacity:.7; }

    /* â”€â”€â”€ Submit â”€â”€â”€ */
    .sbtn {
      width:100%; padding:14px;
      background:linear-gradient(135deg,var(--primary),var(--primary-dark));
      border:none; border-radius:var(--radius); color:#fff;
      font-family:'Tajawal',sans-serif; font-size:1.05rem; font-weight:800;
      cursor:pointer; transition:var(--tr);
      box-shadow:0 6px 20px rgba(252,120,35,.3);
      position:relative; overflow:hidden;
    }
    .sbtn::after { content:''; position:absolute; inset:0; background:rgba(255,255,255,.1); opacity:0; transition:opacity .3s; }
    .sbtn:hover { transform:translateY(-2px); box-shadow:0 10px 28px rgba(252,120,35,.45); }
    .sbtn:hover::after { opacity:1; }
    .sbtn:disabled { opacity:.6; cursor:not-allowed; transform:none; }
    .spin { display:inline-block; width:15px; height:15px; border:2px solid rgba(255,255,255,.35); border-top-color:#fff; border-radius:50%; animation:sp .7s linear infinite; vertical-align:middle; margin-left:7px; }
    @keyframes sp { to{transform:rotate(360deg)} }

    /* â”€â”€â”€ Switch â”€â”€â”€ */
    .sw { text-align:center; margin-top:18px; font-size:.83rem; color:var(--text-muted); }
    .sw a { color:var(--primary); text-decoration:none; font-weight:700; }
    .sw a:hover { text-decoration:underline; }

    /* â”€â”€â”€ Footer â”€â”€â”€ */
    .foot { text-align:center; margin-top:26px; padding-top:18px; border-top:1px solid var(--border); font-size:.78rem; color:var(--text-muted); }
    .foot a { color:var(--primary); text-decoration:none; }

    /* â”€â”€â”€ Back link â”€â”€â”€ */
    .back {
      position:fixed; top:22px; right:26px; z-index:10;
      display:flex; align-items:center; gap:7px;
      color:var(--text-muted); text-decoration:none; font-size:.86rem;
      transition:var(--tr);
    }
    .back:hover { color:var(--primary); }

    /* â”€â”€â”€ Register steps indicator â”€â”€â”€ */
    .steps {
      display:flex; align-items:center; justify-content:center;
      gap:0; margin-bottom:26px;
    }
    .step-item {
      display:flex; flex-direction:column; align-items:center; gap:5px;
      position:relative;
    }
    .step-circle {
      width:34px; height:34px; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      font-size:.82rem; font-weight:800;
      background:rgba(255,255,255,.06); border:2px solid rgba(255,255,255,.1);
      color:var(--text-muted); transition:var(--tr);
    }
    .step-item.active   .step-circle { background:var(--primary); border-color:var(--primary); color:#fff; box-shadow:0 0 16px rgba(252,120,35,.4); }
    .step-item.done     .step-circle { background:rgba(46,204,113,.15); border-color:#2ecc71; color:#2ecc71; }
    .step-label { font-size:.7rem; color:var(--text-muted); white-space:nowrap; }
    .step-item.active .step-label { color:var(--primary); font-weight:700; }
    .step-item.done   .step-label { color:#2ecc71; }
    .step-line {
      flex:1; height:2px; min-width:28px;
      background:rgba(255,255,255,.07);
      margin-bottom:18px; transition:background .4s;
    }
    .step-line.done { background:rgba(46,204,113,.35); }

    /* â”€â”€â”€ Linking cards â”€â”€â”€ */
    .link-cards { display:flex; flex-direction:column; gap:11px; margin-bottom:18px; }

    .lcard {
      display:flex; align-items:center; gap:14px;
      padding:14px 16px; border-radius:14px;
      border:1.5px solid rgba(255,255,255,.08);
      background:rgba(255,255,255,.03);
      cursor:pointer; transition:var(--tr); position:relative; overflow:hidden;
    }
    .lcard::after { content:''; position:absolute; inset:0; opacity:0; transition:opacity .3s; }
    .lcard:hover  { transform:translateY(-2px); }

    .lcard.discord-card { border-color:rgba(88,101,242,.25); }
    .lcard.discord-card:hover { background:rgba(88,101,242,.07); border-color:rgba(88,101,242,.5); box-shadow:0 6px 24px rgba(88,101,242,.15); }
    .lcard.steam-card   { border-color:rgba(102,192,244,.18); }
    .lcard.steam-card:hover { background:rgba(102,192,244,.06); border-color:rgba(102,192,244,.4); box-shadow:0 6px 24px rgba(102,192,244,.12); }
    .lcard.skip-card    { border-color:rgba(255,255,255,.06); cursor:default; }
    .lcard.skip-card:hover { transform:none; }

    .lcard-icon {
      width:44px; height:44px; border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      font-size:1.25rem; flex-shrink:0;
    }
    .discord-card .lcard-icon { background:rgba(88,101,242,.15); color:#5865F2; }
    .steam-card   .lcard-icon { background:rgba(102,192,244,.12); color:#66c0f4; }

    .lcard-info { flex:1; min-width:0; }
    .lcard-title { font-weight:800; color:#e0e0e0; font-size:.93rem; margin-bottom:2px; }
    .lcard-desc  { font-size:.78rem; color:var(--text-muted); line-height:1.45; }

    .lcard-arrow { color:rgba(255,255,255,.2); font-size:.85rem; transition:var(--tr); }
    .lcard:hover .lcard-arrow { color:var(--primary); transform:translateX(-4px); }

    .lcard.linked-done { border-color:rgba(46,204,113,.35); background:rgba(46,204,113,.05); cursor:default; }
    .lcard.linked-done:hover { transform:none; box-shadow:none; }
    .lcard.linked-done .lcard-title { color:#5dda8f; }
    .lcard.linked-done .lcard-arrow { color:#5dda8f; }

    /* success finish */
    .finish-box {
      text-align:center; padding:8px 0 4px;
      animation:pan .4s ease;
    }
    .finish-icon {
      width:64px; height:64px; border-radius:50%;
      background:rgba(46,204,113,.12); border:2px solid rgba(46,204,113,.3);
      display:flex; align-items:center; justify-content:center;
      font-size:1.8rem; margin:0 auto 16px; color:#2ecc71;
      animation:popIn .5s cubic-bezier(.34,1.56,.64,1);
    }
    @keyframes popIn { from{transform:scale(0);opacity:0} to{transform:scale(1);opacity:1} }
    .finish-box h3 { font-size:1.15rem; font-weight:900; color:#fff; margin-bottom:6px; }
    .finish-box p  { font-size:.84rem; color:var(--text-muted); margin-bottom:18px; }
    .finish-links  { display:flex; gap:8px; margin-top:6px; }
    .fl-btn {
      flex:1; padding:10px; border-radius:10px; border:none;
      font-family:'Tajawal',sans-serif; font-size:.88rem; font-weight:800;
      cursor:pointer; transition:var(--tr);
    }
    .fl-primary { background:linear-gradient(135deg,var(--primary),var(--primary-dark)); color:#fff; box-shadow:0 4px 14px rgba(252,120,35,.3); }
    .fl-primary:hover { transform:translateY(-2px); box-shadow:0 8px 20px rgba(252,120,35,.4); }
    .fl-ghost   { background:rgba(255,255,255,.06); color:var(--text-muted); }
    .fl-ghost:hover { background:rgba(255,255,255,.11); color:#fff; }

    /* password strength */
    .pw-strength { margin-top:6px; display:flex; gap:4px; align-items:center; }
    .pw-bar { flex:1; height:3px; border-radius:4px; background:rgba(255,255,255,.07); transition:background .3s; }
    .pw-label { font-size:.72rem; color:var(--text-muted); min-width:40px; text-align:left; }

    @media (max-width:480px) {
      .card { margin:14px; padding:30px 20px 26px; border-radius:18px; }
      .logo img { width:58px; height:58px; }
      .logo h1 { font-size:1.28rem; }
    }
  </style>
</head>
<body>
<div class="bg"></div>

<a href="index.html" class="back">
  <i class="fas fa-arrow-right"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
</a>

<div class="card">

  <!-- Logo -->
  <div class="logo">
    <img src="https://cdn.discordapp.com/avatars/990216490085142578/4b1d6f63ac4b6e1a59a320ef820a2053.png?size=128" alt="Plus Dev">
    <h1>Plus <span>Dev</span></h1>
    <p>Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­ØªÙƒ</p>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab on" id="tab-discord" onclick="switchTab('discord')">
      <i class="fab fa-discord"></i> Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
    </button>
    <button class="tab" id="tab-email" onclick="switchTab('email')">
      <i class="fas fa-envelope"></i> Ø¯Ø®ÙˆÙ„
    </button>
    <button class="tab" id="tab-register" onclick="switchTab('register')">
      <i class="fas fa-user-plus"></i> Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
    </button>
  </div>

  <!-- Alert (shared) -->
  <div class="alert" id="alert"></div>

  <!-- â•â• Discord Panel â•â• -->
  <div class="panel on" id="p-discord">
    <button class="discord-btn" onclick="loginDiscord()">
      <i class="fab fa-discord"></i>
      ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Discord
    </button>
    <p class="discord-note">
      Ø³ÙŠØªÙ… Ø¬Ù„Ø¨ Ø¥ÙŠÙ…ÙŠÙ„Ùƒ Ù…Ù† Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙˆØ­ÙØ¸Ù‡ØŒ Ø¹Ø´Ø§Ù† ØªÙ‚Ø¯Ø± ØªØ³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹ ÙˆØªÙ„Ø§Ù‚ÙŠ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…ÙˆØ¬ÙˆØ¯Ø©.
    </p>
  </div>

  <!-- â•â• Email Panel â•â• -->
  <div class="panel" id="p-email">

    <!-- Link banner -->
    <div class="link-banner" id="link-banner">
      <i class="fab fa-discord" style="color:#9da7fb;margin-left:5px"></i>
      <strong>Ø¥ÙŠÙ…ÙŠÙ„Ùƒ Ù…Ø±ØªØ¨Ø· Ø¨Ø­Ø³Ø§Ø¨ Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯!</strong><br>
      ØªØ¨ØºÙ‰ ØªØ±Ø¨Ø·Ù‡Ù… Ø¹Ø´Ø§Ù† ØªÙ‚Ø¯Ø± ØªØ³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø·Ø±ÙŠÙ‚ØªÙŠÙ† ÙˆØªØ­ØªÙØ¸ Ø¨ÙƒÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒØŸ
      <div class="link-actions">
        <button class="lbtn lbtn-y" onclick="confirmLink()">
          <i class="fab fa-discord"></i> Ù†Ø¹Ù…ØŒ Ø§Ø±ØªØ¨Ø·
        </button>
        <button class="lbtn lbtn-n" onclick="dismissLink()">Ø¯Ø®ÙˆÙ„ ÙÙ‚Ø·</button>
      </div>
    </div>

    <form id="ef" onsubmit="submitEmail(event)" novalidate>
      <div class="fg">
        <label for="em">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
        <div class="iw">
          <input type="email" id="em" placeholder="example@gmail.com" autocomplete="email" required>
          <i class="fas fa-envelope ic"></i>
        </div>
      </div>

      <div class="fg">
        <label for="pw">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <div class="iw">
          <input type="password" id="pw" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" required>
          <i class="fas fa-lock ic"></i>
          <button type="button" class="eye" onclick="togglePw()" title="Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡">
            <i class="fas fa-eye" id="eye"></i>
          </button>
        </div>
      </div>

      <div class="extras">
        <label class="rem">
          <input type="checkbox" id="rem"> ØªØ°ÙƒØ±Ù†ÙŠ
        </label>
        <a href="#" class="forgot" onclick="forgotPw();return false">Ù†Ø³ÙŠØª Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ØŸ</a>
      </div>

      <button type="submit" class="sbtn" id="sbtn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
    </form>

    <div class="sw">
      Ù…Ø§ Ø¹Ù†Ø¯Ùƒ Ø­Ø³Ø§Ø¨ØŸ <a href="#" onclick="switchTab('register');return false">Ø£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</a>
    </div>
  </div>

  <!-- â•â• Register Panel â•â• -->
  <div class="panel" id="p-register">

    <!-- Steps -->
    <div class="steps" id="reg-steps">
      <div class="step-item active" id="step1-item">
        <div class="step-circle" id="s1">1</div>
        <div class="step-label">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
      </div>
      <div class="step-line" id="line1"></div>
      <div class="step-item" id="step2-item">
        <div class="step-circle" id="s2">2</div>
        <div class="step-label">Ø§Ù„Ø±Ø¨Ø·</div>
      </div>
      <div class="step-line" id="line2"></div>
      <div class="step-item" id="step3-item">
        <div class="step-circle" id="s3"><i class="fas fa-check" style="font-size:.7rem"></i></div>
        <div class="step-label">ØªÙ…!</div>
      </div>
    </div>

    <!-- Step 1: Account info -->
    <div id="reg-step1">
      <form id="rf" onsubmit="submitRegister(event)" novalidate>

        <div class="fg">
          <label for="reg-name">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±</label>
          <div class="iw">
            <input type="text" id="reg-name" placeholder="Ù…Ø«Ø§Ù„: Wolf_X" autocomplete="nickname" required>
            <i class="fas fa-user ic"></i>
          </div>
        </div>

        <div class="fg">
          <label for="reg-em">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
          <div class="iw">
            <input type="email" id="reg-em" placeholder="example@gmail.com" autocomplete="email" required>
            <i class="fas fa-envelope ic"></i>
          </div>
        </div>

        <div class="fg">
          <label for="reg-pw">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
          <div class="iw">
            <input type="password" id="reg-pw" placeholder="6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„" oninput="checkStrength(this.value)" required>
            <i class="fas fa-lock ic"></i>
            <button type="button" class="eye" onclick="toggleRegPw()" title="Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡">
              <i class="fas fa-eye" id="reg-eye"></i>
            </button>
          </div>
          <div class="pw-strength">
            <div class="pw-bar" id="pb1"></div>
            <div class="pw-bar" id="pb2"></div>
            <div class="pw-bar" id="pb3"></div>
            <div class="pw-bar" id="pb4"></div>
            <span class="pw-label" id="pw-lbl">â€”</span>
          </div>
        </div>

        <div class="fg">
          <label for="reg-pw2">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
          <div class="iw">
            <input type="password" id="reg-pw2" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
            <i class="fas fa-lock ic"></i>
          </div>
        </div>

        <button type="submit" class="sbtn" id="reg-sbtn">
          Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ <i class="fas fa-arrow-left" style="margin-right:6px;font-size:.85rem"></i>
        </button>
      </form>

      <div class="sw" style="margin-top:14px">
        Ø¹Ù†Ø¯Ùƒ Ø­Ø³Ø§Ø¨ØŸ <a href="#" onclick="switchTab('email');return false">Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„Ùƒ</a>
      </div>
    </div>

    <!-- Step 2: Link accounts -->
    <div id="reg-step2" style="display:none">

      <p style="font-size:.85rem;color:var(--text-muted);margin-bottom:16px;text-align:center;line-height:1.6">
        Ø­Ø³Ø§Ø¨Ùƒ Ø¬Ø§Ù‡Ø²! ğŸ‰<br>
        <span style="font-size:.8rem;color:#555">Ø§Ø±Ø¨Ø· Ø­Ø³Ø§Ø¨Ø§ØªÙƒ Ø¹Ø´Ø§Ù† Ù…Ø§ ØªØ®Ø³Ø± Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª</span>
      </p>

      <div class="link-cards">

        <!-- Discord card -->
        <div class="lcard discord-card" id="link-discord-card" onclick="linkDiscordFromRegister()">
          <div class="lcard-icon"><i class="fab fa-discord"></i></div>
          <div class="lcard-info">
            <div class="lcard-title">Ø±Ø¨Ø· Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯</div>
            <div class="lcard-desc">Ø³Ø¬Ù‘Ù„ Ø¨Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ù„Ø¯Ù…Ø¬ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙˆØµÙˆØ±ØªÙƒ</div>
          </div>
          <i class="fas fa-chevron-left lcard-arrow"></i>
        </div>

        <!-- Steam card -->
        <div class="lcard steam-card" id="link-steam-card" onclick="linkSteamFromRegister()">
          <div class="lcard-icon">
            <img src="https://store.steampowered.com/favicon.ico" style="width:22px;height:22px;filter:brightness(1.3)">
          </div>
          <div class="lcard-info">
            <div class="lcard-title">Ø±Ø¨Ø· Ø³ØªÙŠÙ…</div>
            <div class="lcard-desc">Ø§Ø±Ø¨Ø· Ø­Ø³Ø§Ø¨ Ø³ØªÙŠÙ… Ø¹Ø´Ø§Ù† ØªØ³Ø¬Ù„ Ø¨Ø·Ø±ÙŠÙ‚ØªÙŠÙ†</div>
          </div>
          <i class="fas fa-chevron-left lcard-arrow"></i>
        </div>

      </div>

      <button class="sbtn" onclick="finishRegister()" style="margin-top:4px">
        ØªØ®Ø·Ù‰ ÙˆØ£ÙƒÙ…Ù„ <i class="fas fa-forward" style="margin-right:6px;font-size:.82rem"></i>
      </button>
    </div>

    <!-- Step 3: Done -->
    <div id="reg-step3" style="display:none">
      <div class="finish-box">
        <div class="finish-icon">ğŸ®</div>
        <h3>Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹!</h3>
        <p id="finish-msg">Ø­Ø³Ø§Ø¨Ùƒ Ø¬Ø§Ù‡Ø²ØŒ Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„Ùƒ Ù„Ù„Ù…ÙˆÙ‚Ø¹â€¦</p>
        <div class="finish-links" id="finish-links" style="display:none">
          <button class="fl-btn fl-ghost" onclick="redirectHome()">Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
          <button class="fl-btn fl-primary" onclick="redirectHome()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† ğŸš€</button>
        </div>
      </div>
    </div>

  </div>

  <!-- Footer -->
  <div class="foot">
    Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ <a href="#">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</a> Ùˆ<a href="#">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a>
    <br><br>
    <span style="color:#333">Â© Plus Dev 2025</span>
  </div>

</div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONFIG â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const CLIENT_ID = '1453875994988380373'; 
const REDIRECT_URI = 'https://saai5l.github.io/Plus_/login.html';

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PARTICLES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
(function(){
  const colors=['#fc7823','rgba(252,120,35,0.5)','#e66a1f','rgba(252,120,35,0.25)'];
  for(let i=0;i<20;i++){
    const p=document.createElement('div');
    p.className='particle';
    const s=Math.random()*5+2;
    p.style.cssText=`width:${s}px;height:${s}px;left:${Math.random()*100}vw;`+
      `background:${colors[Math.floor(Math.random()*colors.length)]};`+
      `animation-delay:${Math.random()*15}s;animation-duration:${Math.random()*12+10}s;`;
    document.body.appendChild(p);
  }
})();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function switchTab(t){
  ['discord','email','register'].forEach(id=>{
    document.getElementById('tab-'+id)?.classList.toggle('on',id===t);
    document.getElementById('p-'+id)?.classList.toggle('on',id===t);
  });
  clearAlert();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ALERT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showAlert(msg,type='err'){
  const icons={err:'fa-circle-exclamation',ok:'fa-circle-check',inf:'fa-circle-info'};
  const el=document.getElementById('alert');
  el.className=`alert on ${type}`;
  el.innerHTML=`<i class="fas ${icons[type]}"></i> ${msg}`;
}
function clearAlert(){
  const el=document.getElementById('alert');
  el.className='alert'; el.innerHTML='';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PASSWORD TOGGLE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function togglePw(){
  const i=document.getElementById('pw');
  const e=document.getElementById('eye');
  i.type=i.type==='password'?'text':'password';
  e.className='fas fa-'+(i.type==='text'?'eye-slash':'eye');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• REGISTER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let _regUser = null; // Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³Ø¬Ù‘Ù„ Ù…Ø¤Ù‚ØªØ§Ù‹

function goRegStep(n){
  [1,2,3].forEach(i=>{
    document.getElementById('reg-step'+i).style.display = i===n?'block':'none';
    const item = document.getElementById('step'+i+'-item');
    item.classList.toggle('active', i===n);
    item.classList.toggle('done', i<n);
    if(i<n){
      const circle = document.getElementById('s'+i);
      circle.innerHTML = '<i class="fas fa-check" style="font-size:.7rem"></i>';
    }
  });
  if(n>1) document.getElementById('line1').classList.add('done');
  if(n>2) document.getElementById('line2').classList.add('done');
}

function checkStrength(v){
  const bars  = [1,2,3,4].map(i=>document.getElementById('pb'+i));
  const label = document.getElementById('pw-lbl');
  const colors= ['#e74c3c','#e67e22','#f1c40f','#2ecc71'];
  const texts = ['Ø¶Ø¹ÙŠÙØ©','ÙˆØ³Ø·','Ø¬ÙŠØ¯Ø©','Ù‚ÙˆÙŠØ©'];
  let score = 0;
  if(v.length>=6)  score++;
  if(v.length>=10) score++;
  if(/[A-Z]/.test(v)||/[^a-zA-Z0-9]/.test(v)) score++;
  if(v.length>=14) score++;
  score = Math.max(v.length>0?1:0, score);
  bars.forEach((b,i)=>{ b.style.background = i<score ? colors[score-1] : 'rgba(255,255,255,.07)'; });
  label.textContent = v.length===0?'â€”':texts[score-1]||texts[0];
  label.style.color = v.length===0?'var(--text-muted)':colors[score-1];
}

function toggleRegPw(){
  const i=document.getElementById('reg-pw');
  const e=document.getElementById('reg-eye');
  i.type=i.type==='password'?'text':'password';
  e.className='fas fa-'+(i.type==='text'?'eye-slash':'eye');
}

async function submitRegister(e){
  e.preventDefault(); clearAlert();
  const name = document.getElementById('reg-name').value.trim();
  const email= document.getElementById('reg-em').value.trim().toLowerCase();
  const pass = document.getElementById('reg-pw').value;
  const pass2= document.getElementById('reg-pw2').value;
  const btn  = document.getElementById('reg-sbtn');

  if(!name||!email||!pass||!pass2){ showAlert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„.'); return; }
  if(pass.length<6){ showAlert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.'); return; }
  if(pass!==pass2){ showAlert('ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†.'); return; }

  const accounts = getAccounts();
  if(accounts[email]){ showAlert('Ù‡Ø°Ø§ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹ â€” Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„Ùƒ.','inf'); switchTab('email'); return; }

  btn.disabled=true;
  btn.innerHTML='Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ <span class="spin"></span>';

  _regUser = {
    id:      'em_'+Date.now(),
    name,
    avatar:  `https://cdn.discordapp.com/embed/avatars/${Math.floor(Math.random()*5)}.png`,
    email,
    loginVia:'email'
  };
  saveAccount(email, pass, _regUser);

  // Ø§Ø­ÙØ¸ Ø§Ù„Ø¬Ù„Ø³Ø© Ù…Ø¤Ù‚ØªØ§Ù‹
  localStorage.setItem('user',        JSON.stringify(_regUser));
  localStorage.setItem('plusdev_user',JSON.stringify(_regUser));

  btn.disabled=false;
  btn.innerHTML='Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ <i class="fas fa-arrow-left" style="margin-right:6px;font-size:.85rem"></i>';

  clearAlert();
  goRegStep(2);
}

/* Ø±Ø¨Ø· Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ù…Ù† ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ */
function linkDiscordFromRegister(){
  // Ø§Ø­ÙØ¸ Ø¥Ø´Ø§Ø±Ø© Ø¥Ù†Ù†Ø§ Ø¬Ø§ÙŠÙŠÙ† Ù…Ù† register Ø¹Ø´Ø§Ù† Ù†Ø±Ø¬Ø¹
  sessionStorage.setItem('reg_linking','discord');
  loginDiscord();
}

/* Ø±Ø¨Ø· Ø³ØªÙŠÙ… Ù…Ù† ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ */
function linkSteamFromRegister(){
  sessionStorage.setItem('reg_linking','steam');
  loginSteam();
}

/* Ø¨Ø¹Ø¯ Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ù†Ø§Ø¬Ø­ â€” Ø¹Ù„Ù‘Ù… Ø§Ù„ÙƒØ§Ø±Ø¯ âœ“ */
function markLinked(type){
  const card = document.getElementById('link-'+type+'-card');
  if(!card) return;
  card.classList.add('linked-done');
  card.onclick=null;
  card.querySelector('.lcard-title').innerHTML =
    (type==='discord'?'<i class="fab fa-discord" style="margin-left:5px"></i>':'<i class="fab fa-steam" style="margin-left:5px"></i>')+
    ' ØªÙ… Ø§Ù„Ø±Ø¨Ø· âœ“';
  card.querySelector('.lcard-arrow').className='fas fa-check-circle';
  card.querySelector('.lcard-arrow').style.color='#2ecc71';
}

function finishRegister(){
  goRegStep(3);
  document.getElementById('finish-msg').textContent =
    'Ø­Ø³Ø§Ø¨Ùƒ Ø¬Ø§Ù‡Ø²! Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„Ùƒ Ù„Ù„Ù…ÙˆÙ‚Ø¹â€¦';
  setTimeout(redirectHome, 1800);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DISCORD LOGIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function loginDiscord(){
  const scope=encodeURIComponent('identify email');
  window.location.href=`https://discord.com/api/oauth2/authorize?client_id=${CLIENT_ID}`+
    `&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=token&scope=${scope}`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STEAM LOGIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function loginSteam(){
  const returnTo = encodeURIComponent(REDIRECT_URI + '?steam=1');
  const realm    = encodeURIComponent(REDIRECT_URI.split('/').slice(0,3).join('/'));
  window.location.href =
    `https://steamcommunity.com/openid/login` +
    `?openid.ns=${encodeURIComponent('http://specs.openid.net/auth/2.0')}` +
    `&openid.mode=checkid_setup` +
    `&openid.return_to=${returnTo}` +
    `&openid.realm=${realm}` +
    `&openid.identity=${encodeURIComponent('http://specs.openid.net/auth/2.0/identifier_select')}` +
    `&openid.claimed_id=${encodeURIComponent('http://specs.openid.net/auth/2.0/identifier_select')}`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HANDLE DISCORD CALLBACK â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.addEventListener('load',()=>{
  const frag=new URLSearchParams(window.location.hash.slice(1));
  const token=frag.get('access_token');
  const urlParams = new URLSearchParams(window.location.search);

  /* â”€â”€ Steam OpenID callback â”€â”€ */
  if(urlParams.get('steam')==='1' && urlParams.get('openid.mode')==='id_res'){
    const claimedId = urlParams.get('openid.claimed_id')||'';
    const match = claimedId.match(/\/(\d{17})$/);
    window.history.replaceState({},document.title,window.location.pathname);
    if(match){
      const steamId = match[1];
      const fromReg = sessionStorage.getItem('reg_linking');
      if(fromReg==='steam'){
        sessionStorage.removeItem('reg_linking');
        /* Ø±Ø¨Ø· Ø³ØªÙŠÙ… Ø¨Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¬Ù‘Ù„ */
        const saved = JSON.parse(localStorage.getItem('plusdev_user')||'null');
        if(saved){
          const merged = { ...saved, steamId, loginVia: saved.loginVia==='discord'?'both':'steam' };
          localStorage.setItem('user',         JSON.stringify(merged));
          localStorage.setItem('plusdev_user', JSON.stringify(merged));
          saveSteamLink(steamId, saved.discordId||null);
          switchTab('register');
          goRegStep(2);
          markLinked('steam');
          showAlert('ØªÙ… Ø±Ø¨Ø· Ø³ØªÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­! ğŸ®','ok');
          return;
        }
      }
      /* Ø¯Ø®ÙˆÙ„ Ø¹Ø§Ø¯ÙŠ Ø¨Ø³ØªÙŠÙ… */
      processSteamLogin(steamId);
    } else {
      showAlert('ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø³ØªÙŠÙ…ØŒ Ø¬Ø±Ø¨ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©.');
    }
    return;
  }

  if(token){
    showAlert('Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„â€¦','inf');
    fetch('https://discord.com/api/users/@me',{headers:{Authorization:`Bearer ${token}`}})
      .then(r=>r.json())
      .then(u=>handleDiscordUser(u))
      .catch(()=>showAlert('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ØŒ Ø¬Ø±Ø¨ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©.'));
    window.history.replaceState({},document.title,window.location.pathname);
  } else {
    // âœ… ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ø§ Ø§Ù„Ù…ÙØªØ§Ø­ÙŠÙ†
    try {
      const raw = localStorage.getItem('plusdev_user') || localStorage.getItem('user');
      if (raw) {
        const parsed = JSON.parse(raw);
        if (parsed && parsed.id && parsed.name) {
          // ØªØ£ÙƒØ¯ Ù…Ù† Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ ÙƒÙ„Ø§ Ø§Ù„Ù…ÙØªØ§Ø­ÙŠÙ† Ù‚Ø¨Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„
          const userStr = JSON.stringify(parsed);
          localStorage.setItem('user', userStr);
          localStorage.setItem('plusdev_user', userStr);
          redirectHome();
          return;
        }
      }
      // Ø¥Ø°Ø§ Ù…Ø§ ÙÙŠÙ‡ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø©ØŒ Ø§Ù…Ø³Ø­ ÙƒÙ„ Ø´ÙŠ
      localStorage.removeItem('plusdev_user');
      localStorage.removeItem('user');
      sessionStorage.removeItem('plusdev_user');
    } catch(e) {
      localStorage.removeItem('plusdev_user');
      localStorage.removeItem('user');
      sessionStorage.removeItem('plusdev_user');
    }
  }
});

function handleDiscordUser(u){
  const avatar=u.avatar
    ?`https://cdn.discordapp.com/avatars/${u.id}/${u.avatar}.png`
    :`https://cdn.discordapp.com/embed/avatars/${(u.discriminator||0)%5}.png`;

  const email=(u.email||'').toLowerCase()||null;

  const userData={
    id:       u.id,
    name:     u.global_name||u.username,
    avatar:   avatar,
    email:    email,
    loginVia: 'discord'
  };

  /* Save main user session */
  localStorage.setItem('plusdev_user', JSON.stringify(userData));
  localStorage.setItem('user', JSON.stringify(userData));

  /* Cache Discord data for later merging */
  const du=JSON.parse(localStorage.getItem('pd_discord_users')||'{}');
  du[u.id]=userData;
  localStorage.setItem('pd_discord_users',JSON.stringify(du));

  /* Save email â†’ discordId mapping if email available */
  if(email) saveEmailLink(email, u.id);

  /* â”€â”€ Ù‡Ù„ Ø¬Ø§ÙŠÙŠÙ† Ù…Ù† ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ØŸ â”€â”€ */
  const fromReg = sessionStorage.getItem('reg_linking');
  if(fromReg==='discord'){
    sessionStorage.removeItem('reg_linking');
    // Ø£Ø¯Ù…Ø¬ Ù…Ø¹ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¬Ù‘Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹
    const saved = JSON.parse(localStorage.getItem('plusdev_user')||'null');
    if(saved && saved.email){
      const merged = {
        ...saved,
        id:        u.id,
        avatar:    avatar,
        discordId: u.id,
        loginVia:  'both'
      };
      localStorage.setItem('user',         JSON.stringify(merged));
      localStorage.setItem('plusdev_user', JSON.stringify(merged));
      // Ø£Ø¹Ø¯ Ù„Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ¹Ù„Ù‘Ù… Ø§Ù„ÙƒØ§Ø±Ø¯
      switchTab('register');
      goRegStep(2);
      markLinked('discord');
      showAlert('ØªÙ… Ø±Ø¨Ø· Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰','ok');
      return;
    }
  }

  loginOk(userData, true, 'Ù…Ø±Ø­Ø¨Ø§Ù‹ '+userData.name+'! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„â€¦');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EMAIL LOGIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let pendingLink=null;

async function submitEmail(e){
  e.preventDefault(); clearAlert();
  const email=document.getElementById('em').value.trim().toLowerCase();
  const pass =document.getElementById('pw').value;
  const rem  =document.getElementById('rem').checked;
  const btn  =document.getElementById('sbtn');

  if(!email||!pass){showAlert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„.');return;}
  if(pass.length<6){showAlert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.');return;}

  btn.disabled=true;
  btn.innerHTML='Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ <span class="spin"></span>';

  const discordId=getLinkedDiscordId(email);
  const accounts =getAccounts();

  if(discordId){
    /* Email belongs to a Discord-linked account */
    if(accounts[email]){
      /* Already has password set â†’ normal login */
      if(accounts[email].pass===hash(pass)){
        loginOk(accounts[email].user,rem);
      } else {
        showAlert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.');
      }
    } else {
      /* First time using email for this Discord account â†’ offer linking */
      pendingLink={email,pass,discordId,rem};
      document.getElementById('link-banner').classList.add('on');
      showAlert('ÙˆØ¬Ø¯Ù†Ø§ Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ù…Ø±ØªØ¨Ø· â€” Ø±Ø§Ø¬Ø¹ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø£Ø¹Ù„Ø§Ù‡.','inf');
    }
  } else {
    /* Regular email account */
    if(accounts[email]){
      if(accounts[email].pass===hash(pass)){
        loginOk(accounts[email].user,rem);
      } else {
        showAlert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.');
      }
    } else {
      /* Auto-register on first login */
      const newUser={
        id:      'em_'+Date.now(),
        name:    email.split('@')[0],
        avatar:  `https://cdn.discordapp.com/embed/avatars/${Math.floor(Math.random()*5)}.png`,
        email:   email,
        loginVia:'email'
      };
      saveAccount(email,pass,newUser);
      loginOk(newUser,rem,'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„! ğŸ‰');
    }
  }

  btn.disabled=false;
  btn.innerHTML='ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LINK ACTIONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function confirmLink(){
  if(!pendingLink) return;
  const {email,pass,discordId,rem}=pendingLink;
  const du=JSON.parse(localStorage.getItem('pd_discord_users')||'{}');
  const dc=du[discordId]||null;
  const merged={
    id:        discordId,
    name:      dc?dc.name:email.split('@')[0],
    avatar:    dc?dc.avatar:`https://cdn.discordapp.com/embed/avatars/0.png`,
    email:     email,
    loginVia:  'both',
    discordId: discordId
  };
  saveAccount(email,pass,merged);
  document.getElementById('link-banner').classList.remove('on');
  loginOk(merged,rem,'ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠÙ†! Ø§Ù„Ø¢Ù† ØªÙ‚Ø¯Ø± ØªØ³Ø¬Ù„ Ø¨ÙƒÙ„ØªØ§ Ø§Ù„Ø·Ø±ÙŠÙ‚ØªÙŠÙ† ğŸ‰');
  pendingLink=null;
}

function dismissLink(){
  if(!pendingLink) return;
  const {email,pass,rem}=pendingLink;
  const newUser={
    id:'em_'+Date.now(),
    name:email.split('@')[0],
    avatar:`https://cdn.discordapp.com/embed/avatars/0.png`,
    email:email,loginVia:'email'
  };
  saveAccount(email,pass,newUser);
  document.getElementById('link-banner').classList.remove('on');
  loginOk(newUser,rem);
  pendingLink=null;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FORGOT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function forgotPw(){
  const email=document.getElementById('em').value.trim();
  if(!email){showAlert('Ø§Ø¯Ø®Ù„ Ø¥ÙŠÙ…ÙŠÙ„Ùƒ Ø£ÙˆÙ„Ø§Ù‹.','inf');document.getElementById('em').focus();return;}
  const disc=getLinkedDiscordId(email);
  if(disc){showAlert('Ø­Ø³Ø§Ø¨Ùƒ Ù…Ø±ØªØ¨Ø· Ø¨Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ â€” Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ø¨Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ ÙˆØ¹Ø¯Ù‘Ù„ Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯.','inf');}
  else{showAlert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„. Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ø£ÙˆÙ„Ø§Ù‹.','inf');}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LOGIN SUCCESS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function loginOk(user,rem,msg){
  // âœ… Ø§Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ ÙƒÙ„Ø§ Ø§Ù„Ù…ÙØªØ§Ø­ÙŠÙ† Ø¨Ø´ÙƒÙ„ Ù…ØªØ²Ø§Ù…Ù†
  const userStr = JSON.stringify(user);
  try {
    localStorage.setItem('user', userStr);
    localStorage.setItem('plusdev_user', userStr);
    // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­ÙØ¸
    const verify = localStorage.getItem('user');
    if (!verify) throw new Error('ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸');
  } catch(e) {
    showAlert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø©ØŒ Ø¬Ø±Ø¨ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©.');
    return;
  }
  if(msg) showAlert(msg,'ok');
  else showAlert('Ù…Ø±Ø­Ø¨Ø§Ù‹ ' + (user.name||'') + '! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„â€¦','ok');
  setTimeout(redirectHome, 1200);
}
function redirectHome(){ window.location.href='https://saai5l.github.io/Plus_/index.html'; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STEAM HELPERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function saveSteamLink(steamId, discordId){
  const l=JSON.parse(localStorage.getItem('pd_steam_links')||'{}');
  l[steamId]=discordId;
  localStorage.setItem('pd_steam_links',JSON.stringify(l));
}
function getSteamLink(steamId){
  return (JSON.parse(localStorage.getItem('pd_steam_links')||'{}')||{})[steamId]||null;
}
async function processSteamLogin(steamId){
  showAlert('Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØ³Ø¬ÙŠÙ„ Ø³ØªÙŠÙ…â€¦','inf');
  let steamName='Ù…Ø³ØªØ®Ø¯Ù… Ø³ØªÙŠÙ…';
  let steamAvatar='https://avatars.steamstatic.com/fef49e7fa7e1997310d705b2a6158ff8dc1cdfeb_full.jpg';
  try{
    const r=await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(`https://api.steampowered.com/ISteamUser/GetPlayerSummaries/v2/?key=NOKEY&steamids=${steamId}`)}`,{signal:AbortSignal.timeout(5000)});
    const j=await r.json();
    const p=JSON.parse(j.contents)?.response?.players?.[0];
    if(p){steamName=p.personaname||steamName;steamAvatar=p.avatarfull||steamAvatar;}
  }catch{}
  const user={id:'steam_'+steamId,name:steamName,avatar:steamAvatar,steamId,loginVia:'steam'};
  saveSteamLink(steamId,null);
  loginOk(user,true,'Ø£Ù‡Ù„Ø§Ù‹ '+steamName+'! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ğŸ®');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STORAGE HELPERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function saveEmailLink(email,discordId){
  const l=JSON.parse(localStorage.getItem('pd_email_links')||'{}');
  l[email]=discordId;
  localStorage.setItem('pd_email_links',JSON.stringify(l));
}
function getLinkedDiscordId(email){
  return (JSON.parse(localStorage.getItem('pd_email_links')||'{}')||{})[email]||null;
}
function getAccounts(){
  return JSON.parse(localStorage.getItem('pd_email_accounts')||'{}');
}
function saveAccount(email,pass,user){
  const a=getAccounts();
  a[email]={pass:hash(pass),user};
  localStorage.setItem('pd_email_accounts',JSON.stringify(a));
}

/* Simple hash â€” upgrade to bcrypt/Firebase Auth in production */
function hash(s){
  let h=0;
  for(let i=0;i<s.length;i++){h=Math.imul(31,h)+s.charCodeAt(i)|0;}
  return h.toString(36);
}
</script>
</body>
</html>
